<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="wp Landing page">
    <meta name="author" content="Denis Driamov">
    <link rel="shortcut icon" href="/favicon.ico">

    <title>Wp-loading-page</title>

    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- progress.js -->
    <link href="js/progress.js/progressjs.min.css" rel="stylesheet">

    <!-- owl-carousel -->
    <link href="js/owl-carousel/owl.carousel.css" rel="stylesheet">
    <link href="js/owl-carousel/owl.theme.css" rel="stylesheet">
    <link href="js/owl-carousel/owl.transitions.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="css/wp-loading-page.css" rel="stylesheet">



    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body class="wp-lp">
    <div class="navbar navbar-inverse" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <div class="center-logo-holder">
            <div class="center-logo center-block text-center" style="top: 9px;">
              <img src="images/otonomic-logo.png" class="logo-img" alt="otonomic logo">
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="container-fluid">
      <div class="row">
        <div id="progress-bar"></div>
      </div>
    </div>
    <div class="container-fluid">
        <div class="row">
          <div class="col-xs-12 text-center">
            <div id="owl-slider" class="owl-carousel owl-theme">

              <div class="item"><!-- 1 -->
                <h2 class="progress-text">Creating your new website’s structure...</h2>
                <p><img src="images/gift.png"></p>
                <h3><b>The website you get is free</b></h3>
              </div>
              <div class="item"><!-- 2 -->
                <h2 class="progress-text">Collecting business details from your Facebook page...</h2>
                <p><img src="images/gift.png"></p>
                <h3>The website you get is <b>free</b></h3>
                <p><img src="images/card.png"></p>
                <h3><b>It comes with your Facebook content</b></h3>
              </div>
              <div class="item"><!-- 3 -->
                <h2 class="progress-text">Creating your website’s Home page...</h2>
                <p><img src="images/gift.png"></p>
                <h3>The website you get is <b>free</b></h3>
                <p><img src="images/card.png"></p>
                <h3>It comes with your Facebook content</h3>
                <p><img src="images/mobilev.png"></p>
                <h3><b>It works on all mobile devices</b></h3>
              </div>
              <div class="item"><!-- 4 -->
                <h2 class="progress-text">Collecting posts data from your Facebook page...</h2>
                <p><img src="images/gift.png"></p>
                <h3>The website you get is <b>free</b></h3>
                <p><img src="images/card.png"></p>
                <h3>It comes with your Facebook content</h3>
                <p><img src="images/mobilev.png"></p>
                <h3>It works on all mobile devices</h3>
                <p><img src="images/google.png"></p>
                <h3><b>And ranks high on Google search engine</b></h3>
              </div>
              <div class="item"><!-- 5 -->
                <h2 class="progress-text">Creating your website’s News page...</h2>
                <p><img src="images/gift.png"></p>
                <h3>The website you get is <b>free</b></h3>
                <p><img src="images/card.png"></p>
                <h3>It comes with your Facebook content</h3>
                <p><img src="images/mobilev.png"></p>
                <h3>It works on all mobile devices</h3>
                <p><img src="images/google.png"></p>
                <h3>And ranks high on Google search engine</h3>
              </div>
              <div class="item"><!-- 6 -->
                <h2 class="progress-text">Collecting image data from your Facebook page...</h2>
                <div class="row">
                  <div class="col-md-2 col-md-offset-1 text-left">
                    <h2 class="behold">Behold!<br/>
                    One of our<br/>
                    free templates...</h2>
                  </div>
                </div>
              </div>
              <div class="item"><!-- 7 -->
                <h2 class="progress-text">Creating your website’s Gallery page...</h2>
                <div class="row">
                  <div class="col-md-2 col-md-offset-1 text-left">
                    <h2 class="behold">Behold!<br/>
                    One of our<br/>
                    free templates...</h2>
                  </div>
                  <div class="col-md-9">
                    <div class="devices-holder">
                      <div class="desktop"><img src="images/desktop.png"></div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="item"><!-- 8 -->
                <h2 class="progress-text">Collecting testimonials data from your Facebook page...</h2>
                <div class="row">
                  <div class="col-md-2 col-md-offset-1 text-left">
                    <h2 class="behold">Behold!<br/>
                    One of our<br/>
                    free templates...</h2>
                  </div>
                  <div class="col-md-9">
                    <div class="devices-holder">
                      <div class="desktop"><img src="images/desktop.png"></div>
                      <div class="ipad"><img src="images/ipad.png"></div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="item"><!-- 9 -->
                <h2 class="progress-text">Creating your website's Testimonials page...</h2>
                <div class="row">
                  <div class="col-md-2 col-md-offset-1 text-left">
                    <h2 class="behold">Behold!<br/>
                    One of our<br/>
                    free templates...</h2>
                  </div>
                  <div class="col-md-9">
                    <div class="devices-holder">
                      <div class="desktop"><img src="images/desktop.png"></div>
                      <div class="ipad"><img src="images/ipad.png"></div>
                      <div class="iphone"><img src="images/iphone.png"></div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="item"><!-- 10 -->
                <h2 class="progress-text">Retreivng your social networks data...</h2>
                <div class="row">
                  <div class="col-md-2 col-md-offset-1 text-left">
                    <h2 class="behold">Behold!<br/>
                    One of our<br/>
                    free templates...</h2>
                  </div>
                  <div class="col-md-9">
                    <div class="devices-holder">
                      <div class="desktop"><img src="images/desktop.png"></div>
                      <div class="ipad"><img src="images/ipad.png"></div>
                      <div class="iphone"><img src="images/iphone.png"></div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="item"><!-- 11 -->
                <h2 class="progress-text">Creating your website’s Socials page...</h2>
                <p><img src="images/dollar.png"></p>
                <h3>In case you forgot...</h3>
                <h1>The website you get is <b>free of charge.</b></h1>
              </div>
              <div class="item"><!-- 12 -->
                <h2 class="progress-text">Collecting your contact information from your Facebook page...</h2>
                <p><img src="images/dollar.png"></p>
                <h3>In case you forgot...</h3>
                <h1>The website you get is <b>free of charge.</b></h1>
              </div>
              <div class="item"><!-- 13 -->
                <h2 class="progress-text">Collecting your contact information from your Facebook page...</h2>
                <div class="container">
                  <div class="col-md-1 col-md-offset-2 text-right">
                    <img class="location" src="images/location.png">
                  </div>
                  <div class="col-md-8 text-left">
                    <h4>It seems that some contact details are missing<br/>
                    from your Facebook page.</h4>
                    <h4>It’s important for you to fill them, because websites that<br/>
                    don’t have contact details are considered by customers<br/>
                    as less reliable.</h4>
                    <form role="form" id="business-details" action="">
                      <div class="row">
                        <div class="col-xs-12 col-md-6">
                            <div class="form-group">
                                <label for="productName">Your business address</label>
                                <textarea rows="3" id="address" name="contact_address" class="form-control" placeholder="Enter your business’ physical address here..." autocomplete="off"></textarea>
                            </div>
                            <div class="form-group">
                                <label for="email">Your Email</label>
                                <input type="email" class="form-control" id="email" name="contact_email" value="" placeholder="">
                            </div>
                            <div class="form-group">
                                <label for="phoneNum">Your business phone number</label>
                                <input type="text" class="form-control" id="phone" name="contact_phone" value="" placeholder="">
                            </div>
                            <div class="form-group text-center">
                              <a href="#" onclick="return false;" class="submit btn btn-ttc btn-lg"><span class="glyphicon glyphicon-ok" id="contact-form-btn"></span> Done </a>
                              <h4>We will never misuse your contact information.</h4>
                              <a href="#" onclick="return false;" class="submit-skip" ><h4><u>I don’t want a Contact page in my website</u></h4></a>
                            </div>
                        </div>
                        <div class="col-xs-12 col-md-6">
                          <div class="map_canvas"></div>
                        </div>
                      </div>
                    </form>
                  </div>
                </div>
              </div>
              <div class="item"><!-- 14 -->
                <h2 class="progress-text">Creating your website’s Contact page...</h2>
                <p class="text-center"><span class="glyphicon glyphicon-thumbs-up"></span></p>
                <h3>Just reminding you that...</h3>
                <h1>Your Facebook page is completely safe.</h1>
                <h3>We’re only copying the data to create<br/>
                your new website.</h3>
              </div>
              <div class="item"><!-- 15 -->
                <h2 class="progress-text">Creating an Online Store...</h2>
                <p><img src="images/store.png" style="margin-bottom:20px;"></p>
                <h3 style="margin-bottom:20px;">Would you like to sell your products online?</h3>
                <a href="#" onclick="return false;" class="submit-store btn btn-ttc btn-lg" style="margin-bottom:20px;" id="create_store_btn"><span class="glyphicon glyphicon-ok"></span> Yes, create my Online Store </a>
                <a href="#" onclick="return false;" class="submit-skip" ><h4><u>That’s not relevant to me</u></h4></a>
              </div>
              <div class="item"><!-- 16 -->
                <h2 class="progress-text">Finishing construction of your new website...</h2>
                <p><img src="images/bird.png" style="margin-bottom:20px;"></p>
                <h3>Wrapping a few things up...</h3>
                <h1>Moments away from your new website...</h1>
              </div>
              <div class="item"><!-- 17 -->
                <h2 class="progress-text">Your website was created successfuly!</h2>
                <p class="text-center"><span class="glyphicon glyphicon-ok"></p>
                <h1 style="margin-bottom:40px;">Congratulations!</h1>
                <h3 style="margin-bottom:40px;">Your new website is ready for you.<br/>It’s already available on the Internet.</h3>
                <h4>Now you will be directed to your website to look around.<br/>
                Then you will be guided through some basic editing steps.<br/>
                You will be able to contact us anytime for help.</h4>
                <a href="#" class="submit btn btn-ttc-orange btn-lg" style="margin-bottom:20px;" id="see-my-website-btn"><img src="images/smiley.png"> See my  website! </a>
              </div>
            </div>
          </div>
        </div>
    </div><!-- /.container -->


    <!-- Bootstrap core JavaScript -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/progress.js/progress.min.js"></script>
    <script src="js/owl-carousel/owl.carousel.min.js"></script>
    <script src="http://maps.googleapis.com/maps/api/js?sensor=false&amp;libraries=places"></script>
    <script src="js/jquery.geocomplete.min.js"></script>
    <script type="text/javascript">
      $(function(){

        // start progress-bar for element id='targetElement'
        var slideIndex = 0
        var resetFlag = 6;
        var indexFlag = 0;
       
        var progressBar = progressJs("#progress-bar").start().autoIncrease(1, 500);//.set(0);

        // callback function to call for each change of progress-bar
        progressBar.onprogress(function(targetElm, percent) {

          //console.log("precent:" + percent);
          //console.log("page number: " + owl.currentItem);

          
            if (owl.currentItem == 12) {

              progressBar.set(85);

            } else if (owl.currentItem == 14){

              progressBar.set(92);

            } else if (owl.currentItem == 16){
              progressBar.set(100);
              owl.stop() // Autoplay Stop
              
            } else {

              if (resetFlag == indexFlag){
                owl.next();
                indexFlag = 0;
              } else {
                ++indexFlag;
              };

            };
            
            if (percent == 100) {
                $('.progressjs-theme-blue .progressjs-percent').hide();
                progressBar.end();
                owl.stop() // Autoplay Stop
            };

        });
          
        // owl-carousel init
        $("#owl-slider").owlCarousel({
 
            navigation : false, 
            singleItem:true,
            transitionStyle: "fade",
            //Pagination
            pagination : false,
            paginationNumbers: false,
            //Mouse Events
            dragBeforeAnimFinish : false,
            mouseDrag : false,
            touchDrag : false,
            //Basic Speeds
            slideSpeed : 200,

        });
        //get carousel instance data and store it in variable owl
        var owl = $("#owl-slider").data('owlCarousel');

        // Submit
        $('.submit').click(function(e){
          e.preventDefault();
          var form = $('#business-details');
          $.ajax( {
            type: "POST",
            url: form.attr( 'action' ),
            data: form.serialize(),
            success: function( response ) {
              console.log( response );
            }
          });
          owl.next();
        });
        $('.submit-skip').click(function(e){
          e.preventDefault();
          owl.next();
        });

        // Submit Store
        $('.submit-store').click(function(e){
          e.preventDefault();
          $.ajax( {
            type: "POST",
            url: "some_url",
            data: {'is_store':'true'},
            success: function( response ) {
              console.log( response );
            }
          });
          owl.next();
        });

        var options = {
          map: ".map_canvas",
          location: "new york"
        };
        $("#address").trigger("geocode");
        $("#address").geocomplete(options)
          .bind("geocode:result", function(event, result){
            //$.log("Result: " + result.formatted_address);
          })
          .bind("geocode:error", function(event, status){
            //$.log("ERROR: " + status);
          })
          .bind("geocode:multiple", function(event, results){
            //$.log("Multiple: " + results.length + " results found");
          });
        
        });
      </script>





      <script>

          function getParameterByName(name) {
              name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
              var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
                  results = regex.exec(location.search);
              return results == null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
          }

          var page_id = getParameterByName('page_id');

          $('#see-my-website-btn').click(function(){
              window.location.href = window.blog_redirect;
          });

          if(page_id){

              $.get("http://iproplay.com/migration/index.php?facebook_id="+ page_id +"&theme=parallax", function( data ) {
               
                  window.is_blog_ready = 1;

                  if (data.redirect.indexOf("http://") < 0){
                      data.redirect = "http://"+ data.redirect;
                  }

                  window.blog_redirect = data.redirect;
                  window.blog_id = data.blog_id;
                  window.token = data.token;


                  $('#see-my-website-btn').attr('href',data.redirect);

                  console.log(data)
                  blog_created();

              }, "json" );


              $.get("https://graph.facebook.com/"+ page_id , function( data ) {
               
                  delete data.location.latitude;
                  delete data.location.longitude;

                    var address_parts = [];

                    for(var x in data.location){
                      address_parts.push(data.location[x]);
                    }


                  var phone = (data.phone) ? data.phone : "";
                  var address = (address_parts.join(", ")) ? address_parts.join(", ") : "";
                  var email = (data.email) ? (data.email) : "";


                  window.parsed_page_data = {
                      'phone' : phone,
                      'address' : address,
                      'email' : email
                  }

                  console.log(data);
                  console.log(window.parsed_page_data);


                  $('#address').val(window.parsed_page_data.address);
                  $('#email').val(window.parsed_page_data.email);
                  $('#phone').val(window.parsed_page_data.phone);

                  jQuery('#address').geocomplete('find',jQuery('#address').val());

              }, "json" );
        }




          function blog_created(){

              if(window.is_contact_saved == 1){

                 send_contact_data();
                 
              }

              if(window.i_need_store == 1){
                send_need_store();
              }

            return;
          }


          function contact_form_submited (){

              window.is_contact_saved = 1;

              if(window.is_blog_ready == 1){
               
                send_contact_data();

              } else {
                  window.users_contacts = {
                    'phone' : $('#phone').val(),
                    'address' : $('#address').val(),
                    'email' : $('#email').val()
                 }

              }

          }


          function send_contact_data(){

                if(window.users_contacts != undefined){
                  var _phone = window.users_contacts.phone;
                  var _email = window.users_contacts.email;
                  var _address = window.users_contacts.address;
                } else {
                  var _phone = $('#phone').val();
                  var _email = $('#address').val();
                  var _address = $('#email').val();
                }


                $.post( "http://iproplay.com/wp-admin/admin-ajax.php?action=wp_otonomic_migrate&cmd=update_address&token="+ window.token, { contact_phone: _phone, contact_address: _address, contact_email: _email })
                  .done(function( data ) {
                    //
                  });
          }

          function send_need_store(){

                $.get( "http://iproplay.com/wp-admin/admin-ajax.php?action=wp_otonomic_migrate&cmd=create_store&token="+ window.token )
                  .done(function( data ) {
                    //
                  });

          }


          $('#contact-form-btn').click(function(){
             contact_form_submited ();
          });

          $('#create_store_btn').click(function(){

            if(window.is_blog_ready == 1){

              send_need_store();

            } else {
              window.i_need_store = 1;
            }

          });


          


      </script>
  </body>
</html>
